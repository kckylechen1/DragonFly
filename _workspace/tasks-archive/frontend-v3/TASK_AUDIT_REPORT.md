# ğŸ“‹ Frontend V3 ä»»åŠ¡æ–‡ä»¶å®¡è®¡æŠ¥å‘Š

> **å®¡è®¡æ—¥æœŸ**: 2026-01-30  
> **å®¡è®¡èŒƒå›´**: `tasks/epics/frontend-v3/` ä¸‹æ‰€æœ‰ä»»åŠ¡æ–‡ä»¶  
> **ç»“è®º**: âš ï¸ å‘ç° 12 ä¸ªé—®é¢˜éœ€ä¿®å¤  
> **Oracle å®¡é˜…**: âœ… å·²æ•´åˆ Oracle å»ºè®®

---

## ğŸ”® Oracle å®¡é˜…æ„è§æ‘˜è¦

Oracle å¯¹ä¼˜å…ˆçº§åˆ†ç±»æå‡ºäº†è°ƒæ•´å»ºè®®ï¼š

| åŸä¼˜å…ˆçº§ | Oracle å»ºè®® | ç†ç”± |
|----------|-------------|------|
| P0: README æ›´æ–° | **é™è‡³ P1/P2** | README ä¸å‚ä¸å®é™…æ‰§è¡Œé“¾è·¯ï¼ŒGuide æ‰æ˜¯è¿è¡Œæ‰‹å†Œ |
| P2: C-000 å‘½åå†²çª | **å‡è‡³ P1** | è¿‡å¤œæ‰§è¡Œæ—¶æ’åº/å¼•ç”¨å®¹æ˜“é€‰é”™ï¼Œåç»­æ’éšœæˆæœ¬é«˜ |
| P0: C-003 è¯­æ³•é”™è¯¯ | **ä¿æŒ P0** | ä¸èƒ½æŒ‡æœ›æ‰§è¡Œä»£ç†"é¡ºæ‰‹ä¿®å¥½"ï¼Œä¼šå¯¼è‡´é”™è¯¯äº§ç‰©å †å  |

**Oracle å…³é”®æé†’**:
1. **å¹¶è¡Œåˆå¹¶å†²çªé£é™©** - `index.ts` èšåˆæ–‡ä»¶éœ€æ˜ç¡®è´£ä»»å½’å±
2. **StrictMode åŒè¿æ¥** - WS/SSE å¿…é¡»å¹‚ç­‰ï¼Œå¦åˆ™ dev ä¸‹åŒè¿æ¥éš¾æ’æŸ¥
3. **Wave checkpoint ç¼ºå¤±** - å»ºè®®æ¯ä¸ª Wave ä¸€ä¸ªå¯å›æ»šç‚¹
4. **ä¾èµ–å®‰è£…åº”ç»Ÿä¸€** - åªå…è®¸ L-001 ä¿®æ”¹ lockfileï¼Œé¿å…å¤š agent å†²çª

---

## âš ï¸ å¹¶è¡Œæ‰§è¡Œå¯è¡Œæ€§åˆ†æ (Oracle æœ€ç»ˆç¡®è®¤)

### ç»“è®ºï¼šâŒ ä¸èƒ½å®Œå…¨å¹¶è¡Œï¼Œâœ… å¯åˆ†é˜¶æ®µå¹¶è¡Œ

Oracle æ˜ç¡®æŒ‡å‡ºï¼š**å½“å‰ä»»åŠ¡æ‹†åˆ†ä¸èƒ½è®© 4 ä¸ª Agent "å®Œå…¨å¹¶è¡Œ"è·‘åˆ°åº•**ã€‚

#### ä¸èƒ½å®Œå…¨å¹¶è¡Œçš„åŸå› 

| ä¾èµ–ç±»å‹ | å…·ä½“é—®é¢˜ | å½±å“ |
|----------|----------|------|
| **ç±»å‹ä¾èµ–** | Codex C-002/C-003/C-006 ä¾èµ– GLM çš„ `types/market.ts`, `types/chat.ts` | Codex å¿…é¡»ç­‰ GLM types è½åœ° |
| **Store ä¾èµ–** | Codex éœ€è¦ `stores/market.store.ts` çš„ `batchUpdateTicks` | Codex å¿…é¡»ç­‰ GLM stores è½åœ° |
| **Lockfile å†²çª** | åªå…è®¸ L-001 ä¿®æ”¹ä¾èµ– | Codex ä¸èƒ½ç‹¬ç«‹è£…ä¾èµ– |
| **index.ts å†²çª** | å¤š Agent åŒæ—¶æ”¹ `stores/index.ts`, `hooks/index.ts` | å¿…å†²çª |

#### æ¨èæ‰§è¡Œæ¨¡å‹ï¼šåˆ†é˜¶æ®µå¹¶è¡Œ (Staggered Parallel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ‰§è¡Œæ—¶é—´çº¿                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Wave 0 (å¹¶è¡Œ)                                                          â”‚
â”‚  â”œâ”€â”€ GLM: L-000 (performance.store)                                    â”‚
â”‚  â”œâ”€â”€ Codex: C-000a (state machine), C-000b (debug)                     â”‚
â”‚  â””â”€â”€ Droid: D-000 (toggle)                                             â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼  â•â•â•â• Gate 0: åˆå¹¶æŠ¤æ åŸºçº¿ â•â•â•â•                                  â”‚
â”‚                                                                         â”‚
â”‚  Gate 1 (GLM é¡ºåºæ‰§è¡Œï¼ŒCodex ç­‰å¾…)                                       â”‚
â”‚  â””â”€â”€ GLM: L-001 â†’ L-002 â†’ L-003 â†’ L-004                                â”‚
â”‚       â”‚   (ä¾èµ–)  (types)  (types)  (stores)                            â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼  â•â•â•â• Gate 1: Types/Stores åŸºçº¿è½åœ° â•â•â•â•                         â”‚
â”‚                                                                         â”‚
â”‚  Wave 1+ (å¹¶è¡Œ)                                                         â”‚
â”‚  â”œâ”€â”€ GLM: L-005 ~ L-016 (å¸ƒå±€ã€Chatã€é¢æ¿)                              â”‚
â”‚  â””â”€â”€ Codex: C-001 ~ C-008 (tickBufferã€SSEã€Kçº¿)                        â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼  â•â•â•â• Gate 2: æ ¸å¿ƒåŠŸèƒ½å®Œæˆ â•â•â•â•                                  â”‚
â”‚                                                                         â”‚
â”‚  Wave 4 (é¡ºåº)                                                          â”‚
â”‚  â”œâ”€â”€ Droid: D-001 ~ D-003 (æ ·å¼å¾®è°ƒ)                                    â”‚
â”‚  â””â”€â”€ Amp: A-001 ~ A-002 (ä»£ç å®¡æŸ¥)                                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### index.ts å†²çªè§£å†³æ–¹æ¡ˆ (Oracle æ¨è)

**é—®é¢˜**: å¤š Agent åŒæ—¶æ”¹ `stores/index.ts` ç­‰èšåˆæ–‡ä»¶å¿…å†²çª

**è§£å†³æ–¹æ¡ˆ**: Codex ä¸ç›´æ¥æ”¹ index.tsï¼Œæ”¹ä¸ºæ–°å¢ç‹¬ç«‹èšåˆæ–‡ä»¶

```typescript
// Codex åˆ›å»ºè‡ªå·±çš„èšåˆæ–‡ä»¶
// hooks/codex.ts
export { useStreamingChat } from './useStreamingChat';
export { useMarketWebSocket } from './useMarketWebSocket';

// stores/codex.ts (å¦‚éœ€è¦)
// ç”± GLM åœ¨ Gate åˆå¹¶æ—¶ç»Ÿä¸€ re-export åˆ°ä¸» index.ts
```

**ä¿®æ”¹åçš„æ–‡ä»¶æ‰€æœ‰æƒ**:

| æ–‡ä»¶ | è´Ÿè´£ Agent | è§„åˆ™ |
|------|-----------|------|
| `types/index.ts` | GLM | **åªè¯»** (å…¶ä»– Agent ç¦æ­¢ä¿®æ”¹) |
| `stores/index.ts` | GLM | **åªè¯»** (Codex ç”¨ `stores/codex.ts`) |
| `hooks/index.ts` | GLM | **åªè¯»** (Codex ç”¨ `hooks/codex.ts`) |
| `hooks/codex.ts` | Codex | **æ–°å¢** (Codex è‡ªå·±çš„èšåˆ) |
| `realtime/index.ts` | Codex | **ç‹¬å ** |

#### å¿…é¡»ç­‰å¾…çš„ä¾èµ–å…³ç³»

| Codex ä»»åŠ¡ | ä¾èµ–çš„ GLM ä»»åŠ¡ | åŸå›  |
|------------|----------------|------|
| C-001 tickBuffer | L-003 (MarketTick ç±»å‹) | éœ€è¦ `types/market.ts` |
| C-002 marketClient | L-003 + L-004 | éœ€è¦ types + stores |
| C-003 streamingChat | L-002 + L-004 | éœ€è¦ chat types + stores |
| C-006 KLinePanel | L-003 + L-013 + L-014 | éœ€è¦ types + panel registry + workspace |

#### å¯ä»¥çœŸæ­£å¹¶è¡Œçš„ä»»åŠ¡

| é˜¶æ®µ | GLM ä»»åŠ¡ | Codex ä»»åŠ¡ | è¯´æ˜ |
|------|----------|------------|------|
| Wave 0 | L-000 | C-000a, C-000b | æ— ä¾èµ–ï¼Œå¯å®Œå…¨å¹¶è¡Œ |
| Gate 1 å | L-005~L-007 | C-001 | ä½è€¦åˆ |
| Gate 1 å | L-008~L-012 | C-002~C-005 | ä¸­è€¦åˆï¼Œä½†ä¸åŒæ–‡ä»¶ |
| Gate 1 å | L-013~L-016 | C-006~C-008 | ä¸­è€¦åˆï¼Œä½†ä¸åŒæ–‡ä»¶ |

---

## ğŸ“Š æ–‡ä»¶æ¸…å•

| Agent | ä»»åŠ¡æ•° | Guide | çŠ¶æ€ |
|-------|--------|-------|------|
| ğŸ”µ GLM | 17 (L-000 ~ L-016) | âœ… | âš ï¸ éœ€æ›´æ–° |
| ğŸŸ¢ Codex | 10 (C-000 x2, C-001 ~ C-008) | âœ… | âš ï¸ éœ€æ›´æ–° |
| ğŸŸ  Droid | 4 (D-000 ~ D-003) | âœ… | âœ… OK |
| ğŸŸ£ Amp | 2 (A-001, A-002) | âœ… | âœ… OK |

---

## ğŸ”´ ä¸¥é‡é—®é¢˜ (å¿…é¡»ä¿®å¤)

### 1. C-003-streaming-chat.md ä»£ç è¯­æ³•é”™è¯¯

**æ–‡ä»¶**: `codex/C-003-streaming-chat.md`  
**ä½ç½®**: ç¬¬ 116-163 è¡Œ  
**é—®é¢˜**: `SSEDeduplicator` ç±»å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨ï¼Œä¸” `useStreamingChat` å‡½æ•°è¢«å®šä¹‰äº†ä¸¤æ¬¡

```typescript
// ç¬¬ä¸€æ¬¡å®šä¹‰
export function useStreamingChat(
  options: UseStreamingChatOptions = {}
): UseStreamingChatReturn {
  // ... ç¬¬ 72-114 è¡Œ
}

// ç±»å®šä¹‰æ’åœ¨ä¸­é—´ï¼ˆé”™è¯¯ä½ç½®ï¼‰
class SSEDeduplicator { ... }  // ç¬¬ 122-140 è¡Œ

// ç¬¬äºŒæ¬¡å®šä¹‰ï¼ˆé‡å¤ï¼ï¼‰
export function useStreamingChat(  // ç¬¬ 148 è¡Œ
```

**ä¿®å¤æ–¹æ¡ˆ**: 
1. å°† `SSEDeduplicator` ç±»ç§»åˆ°æ–‡ä»¶é¡¶éƒ¨ï¼ˆå‡½æ•°å¤–ï¼‰
2. åˆ é™¤ç¬¬äºŒæ¬¡ `useStreamingChat` å‡½æ•°å®šä¹‰
3. å®Œæ•´å®ç° `connect` å‡½æ•°

---

### 2. GLM-OVERNIGHT-GUIDE.md ä»»åŠ¡åˆ—è¡¨ä¸å®é™…æ–‡ä»¶ä¸åŒ¹é…

**æ–‡ä»¶**: `glm/GLM-OVERNIGHT-GUIDE.md`  
**é—®é¢˜**: Guide ä¸­æœªåŒ…å« L-000 (performance.store.ts)

**å½“å‰ Guide ä»»åŠ¡åˆ—è¡¨**:
```
L-001 â†’ L-002 â†’ L-003 â†’ L-004 â†’ ... â†’ L-016
```

**å®é™…æ–‡ä»¶**:
```
L-000-performance-store.md  â† ç¼ºå¤±ï¼
L-001-install-deps.md
...
```

**ä¿®å¤æ–¹æ¡ˆ**: æ›´æ–° Guideï¼Œåœ¨ Wave 1 å¼€å¤´æ·»åŠ  L-000

---

### 3. CODEX-OVERNIGHT-GUIDE.md ä»»åŠ¡åˆ—è¡¨ä¸å®é™…æ–‡ä»¶ä¸åŒ¹é…

**æ–‡ä»¶**: `codex/CODEX-OVERNIGHT-GUIDE.md`  
**é—®é¢˜**: Guide ä¸­æœªåŒ…å«ä¸¤ä¸ª C-000 ä»»åŠ¡

**å½“å‰ Guide ä»»åŠ¡åˆ—è¡¨**:
```
C-001 â†’ C-002 â†’ ... â†’ C-008
```

**å®é™…æ–‡ä»¶**:
```
C-000-connection-state-machine.md  â† ç¼ºå¤±ï¼
C-000-realtime-debug.md            â† ç¼ºå¤±ï¼
C-001-tick-buffer.md
...
```

**ä¿®å¤æ–¹æ¡ˆ**: æ›´æ–° Guideï¼Œåœ¨ Wave 1 å¼€å¤´æ·»åŠ ä¸¤ä¸ª C-000 ä»»åŠ¡

---

### 4. DROID-OVERNIGHT-GUIDE.md ä»»åŠ¡åˆ—è¡¨ä¸å®Œæ•´

**æ–‡ä»¶**: `droid/DROID-OVERNIGHT-GUIDE.md`  
**é—®é¢˜**: åªåˆ—äº† D-001 ~ D-003ï¼Œç¼ºå°‘ D-000

**å½“å‰ Guide ä»»åŠ¡åˆ—è¡¨**:
```markdown
| 1 | D-001 | D-001-responsive-testing.md | 20 min |
| 2 | D-002 | D-002-settings-panel.md | 40 min |
| 3 | D-003 | D-003-style-refinement.md | 30 min |
```

**å®é™…æ–‡ä»¶**:
```
D-000-performance-mode-toggle.md  â† ç¼ºå¤±ï¼
D-001-responsive-testing.md
D-002-settings-panel.md
D-003-style-refinement.md
```

**ä¿®å¤æ–¹æ¡ˆ**: æ›´æ–° Guideï¼Œæ·»åŠ  D-000 ä¸ºç¬¬ä¸€ä¸ªä»»åŠ¡

---

### 5. README.md æœªåæ˜  Wave 0 / C-000 / L-000 / D-000 ä»»åŠ¡

**æ–‡ä»¶**: `README.md`  
**é—®é¢˜**: ç›®å½•ç»“æ„å’Œæ‰§è¡Œæ³¢æ¬¡æœªåŒ…å«æ–°å¢çš„ -000 ä»»åŠ¡

**ä¿®å¤æ–¹æ¡ˆ**: æ›´æ–° README.md ä»¥åæ˜ :
- æ–°å¢ L-000, C-000 x2, D-000 ä»»åŠ¡
- Wave 0 çš„å­˜åœ¨ï¼ˆOracle æŠ¤æ ä»»åŠ¡ï¼‰

---

## ğŸŸ¡ ä¸­ç­‰é—®é¢˜ (å»ºè®®ä¿®å¤)

### 6. ä»»åŠ¡æ–‡ä»¶ç¼ºå°‘ Git Commit æ­¥éª¤

**å½±å“æ–‡ä»¶**: æ‰€æœ‰ L-xxx, C-xxx, D-xxx ä»»åŠ¡æ–‡ä»¶  
**é—®é¢˜**: ä»»åŠ¡å®Œæˆåæ²¡æœ‰æ˜ç¡®çš„ git commit æŒ‡å¼•

**å»ºè®®ä¿®å¤**: åœ¨æ¯ä¸ªä»»åŠ¡æ–‡ä»¶æœ«å°¾æ·»åŠ :

```markdown
### Step N: æäº¤

\`\`\`bash
git add client/src/refactor_v2/xxx/
git commit -m "feat(v3): add xxx"
\`\`\`
```

---

### 7. L-004-stores.md ç¼ºå°‘ performance.store å¯¼å‡º

**æ–‡ä»¶**: `glm/L-004-stores.md`  
**é—®é¢˜**: `stores/index.ts` æœªå¯¼å‡º `usePerformanceStore`

**å½“å‰ä»£ç ** (ç¬¬ 260-268 è¡Œ):
```typescript
export { useChatStore } from "./chat.store";
export { useMarketStore } from "./market.store";
export { useUIStore } from "./ui.store";
export { useConnectionStore } from "./connection.store";
// ç¼ºå°‘ performance.store!
```

**ä¿®å¤æ–¹æ¡ˆ**: æ·»åŠ  `export { usePerformanceStore } from "./performance.store";`

ä½†è¿™å–å†³äºæ‰§è¡Œé¡ºåºï¼š
- å¦‚æœ L-000 åœ¨ L-004 ä¹‹å‰æ‰§è¡Œ â†’ L-004 åº”è¯¥å¯¼å‡º
- å¦‚æœ L-000 åœ¨ L-004 ä¹‹åæ‰§è¡Œ â†’ L-000 åº”è¯¥æ›´æ–° index.ts

**å»ºè®®**: L-000 ä»»åŠ¡æ–‡ä»¶ä¸­æ˜ç¡®è¦æ±‚æ›´æ–° `stores/index.ts`

---

### 8. C-002-market-client.md ç¼ºå°‘ä¸ connectionStateMachine çš„é›†æˆ

**æ–‡ä»¶**: `codex/C-002-market-client.md`  
**é—®é¢˜**: marketClient æ²¡æœ‰ä½¿ç”¨ C-000 ä¸­åˆ›å»ºçš„ `ConnectionStateMachine`

**å½“å‰ä»£ç **: marketClient è‡ªå·±ç®¡ç†çŠ¶æ€å­—ç¬¦ä¸²

**å»ºè®®ä¿®å¤**: åœ¨ C-002 ä»»åŠ¡æè¿°ä¸­æ·»åŠ :
> ä½¿ç”¨ `C-000` ä¸­åˆ›å»ºçš„ `ConnectionStateMachine` ç®¡ç†è¿æ¥çŠ¶æ€

---

### 9. L-006-main-layout.md åˆ›å»ºäº†æœªæ¥ä¼šè¢«è¦†ç›–çš„å ä½ç»„ä»¶

**æ–‡ä»¶**: `glm/L-006-main-layout.md`  
**é—®é¢˜**: Step 2 åˆ›å»ºäº† `ChatWorkspace.tsx` å’Œ `StockWorkspace.tsx` å ä½ç»„ä»¶

è¿™äº›ç»„ä»¶ä¼šåœ¨åç»­ä»»åŠ¡ (L-008, L-014) ä¸­è¢«å®Œæ•´å®ç°ï¼Œå¯èƒ½å¯¼è‡´:
1. æ–‡ä»¶è¢«è¦†ç›–æ—¶ git å†²çª
2. GLM å›°æƒ‘æ˜¯å¦åº”è¯¥è¦†ç›–

**å»ºè®®ä¿®å¤**: 
- åœ¨ L-006 ä¸­æ˜ç¡®è¯´æ˜è¿™æ˜¯"å ä½ç»„ä»¶"
- åœ¨ L-008/L-014 ä¸­æ˜ç¡®è¯´æ˜"è¦†ç›–ä¹‹å‰çš„å ä½ç»„ä»¶"

---

### 10. TASKS.md ä¸ç‹¬ç«‹ä»»åŠ¡æ–‡ä»¶å†…å®¹é‡å¤

**å½±å“æ–‡ä»¶**: `glm/TASKS.md`, `codex/TASKS.md`  
**é—®é¢˜**: TASKS.md åŒ…å«å®Œæ•´ä»£ç ç¤ºä¾‹ï¼Œä¸ç‹¬ç«‹ .md æ–‡ä»¶é‡å¤

**é£é™©**: 
- ç»´æŠ¤ä¸¤ä»½ç›¸åŒå†…å®¹
- å¯èƒ½å‡ºç°ä¸ä¸€è‡´

**å»ºè®®**: 
- TASKS.md ä½œä¸ºæ¦‚è¿°ï¼Œåªåˆ—ä»»åŠ¡æ¸…å•
- è¯¦ç»†ä»£ç æ”¾åœ¨ç‹¬ç«‹ä»»åŠ¡æ–‡ä»¶ä¸­
- æˆ–åˆ é™¤ TASKS.mdï¼Œåªä¿ç•™ Guide + ç‹¬ç«‹ä»»åŠ¡æ–‡ä»¶

---

### 11. C-006-kline-panel.md ä¾èµ–é¡¹å®‰è£…ä½ç½®ä¸æ˜ç¡®

**æ–‡ä»¶**: `codex/C-006-kline-panel.md`  
**é—®é¢˜**: Step 1 è¦æ±‚å®‰è£… `lightweight-charts`ï¼Œä½† L-001 å·²ç»åº”è¯¥å®‰è£…æ‰€æœ‰ä¾èµ–

**å½“å‰ L-001 ä¾èµ–åˆ—è¡¨** (glm/L-001-install-deps.md):
```bash
pnpm add framer-motion react-resizable-panels cmdk react-markdown remark-gfm
pnpm add -D @tanstack/react-virtual
```

**ç¼ºå°‘**: `lightweight-charts`

**ä¿®å¤æ–¹æ¡ˆ**: åœ¨ L-001 ä¸­æ·»åŠ  `lightweight-charts` åˆ°ä¾èµ–åˆ—è¡¨

---

### 12. ä¸¤ä¸ª C-000 æ–‡ä»¶å‘½åå†²çª

**æ–‡ä»¶**: 
- `codex/C-000-connection-state-machine.md`
- `codex/C-000-realtime-debug.md`

**é—®é¢˜**: ä¸¤ä¸ªæ–‡ä»¶éƒ½ä½¿ç”¨ C-000 å‰ç¼€ï¼Œåœ¨æ’åºå’Œå¼•ç”¨æ—¶å¯èƒ½æ··æ·†

**å»ºè®®ä¿®å¤**: 
- `C-000a-connection-state-machine.md`
- `C-000b-realtime-debug.md`

æˆ–æ”¹ä¸º:
- `C-000-connection-state-machine.md` (ä¿æŒ)
- `C-001-realtime-debug.md` â†’ åç»­ä»»åŠ¡ç¼–å· +1

---

## âœ… æ­£ç¡®å®ç°çš„éƒ¨åˆ†

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| Oracle æŠ¤æ ä»»åŠ¡å·²åˆ›å»º | âœ… | L-000, C-000 x2, D-000 |
| èƒŒå‹ç­–ç•¥å·²æ·»åŠ  | âœ… | C-001 tickBuffer åŒ…å«èƒŒå‹é€»è¾‘ |
| SSE å»é‡çª—å£ | âœ… | C-003 åŒ…å« SSEDeduplicator (ä½†ä»£ç ä½ç½®é”™è¯¯) |
| æ€§èƒ½æ¨¡å¼ Store | âœ… | L-000 æ­£ç¡®å®ç° |
| PerformanceModeToggle | âœ… | D-000 æ­£ç¡®å®ç° |
| ConnectionStateMachine | âœ… | C-000 æ­£ç¡®å®ç° |
| ä»»åŠ¡æœ‰å‰ç½®ä¾èµ–å£°æ˜ | âœ… | å¤§å¤šæ•°ä»»åŠ¡éƒ½æœ‰ |
| éªŒæ”¶æ ‡å‡†æ˜ç¡® | âœ… | æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ checklist |

---

## ğŸ”§ ä¿®å¤ä¼˜å…ˆçº§ (Oracle è°ƒæ•´å)

### P0 - å¯åŠ¨å‰å¿…é¡»ä¿®å¤

| åºå· | é—®é¢˜ | ä¿®å¤æ–‡ä»¶ | é¢„è®¡æ—¶é—´ |
|------|------|----------|----------|
| 1 | C-003 è¯­æ³•é”™è¯¯ | `codex/C-003-streaming-chat.md` | 15min |
| 2 | GLM Guide ç¼º L-000 | `glm/GLM-OVERNIGHT-GUIDE.md` | 5min |
| 3 | Codex Guide ç¼º C-000 | `codex/CODEX-OVERNIGHT-GUIDE.md` | 5min |
| 4 | Droid Guide ç¼º D-000 | `droid/DROID-OVERNIGHT-GUIDE.md` | 5min |

**æ€»è®¡**: ~30 åˆ†é’Ÿ

### P1 - å¼ºçƒˆå»ºè®®å¯åŠ¨å‰ä¿®å¤ (Oracle è°ƒæ•´)

| åºå· | é—®é¢˜ | ä¿®å¤æ–‡ä»¶ | é¢„è®¡æ—¶é—´ | Oracle è¯´æ˜ |
|------|------|----------|----------|-------------|
| 5 | **C-000 å‘½åå†²çª** â¬†ï¸ | é‡å‘½åæ–‡ä»¶ | 5min | ä» P2 å‡çº§ï¼Œé¿å…æ‰§è¡Œé¡ºåºé”™è¯¯ |
| 6 | L-001 ç¼º lightweight-charts | `glm/L-001-install-deps.md` | 2min | ç»Ÿä¸€ä¾èµ–å…¥å£ |
| 7 | L-000 æ›´æ–° index.ts | `glm/L-000-performance-store.md` | 5min | æ˜ç¡®å¯¼å‡ºè´£ä»» |
| 8 | C-002 é›†æˆçŠ¶æ€æœº | `codex/C-002-market-client.md` | 10min | é¿å…çŠ¶æ€ç®¡ç†åŒä½“ç³» |
| 9 | README æ›´æ–° â¬‡ï¸ | `README.md` | 10min | ä» P0 é™çº§ï¼Œä¸å½±å“æ‰§è¡Œé“¾è·¯ |
| 10 | **index.ts è´£ä»»å½’å±** ğŸ†• | å„ Guide | 10min | Oracle æ–°å¢ï¼Œé˜²æ­¢åˆå¹¶å†²çª |
| 11 | **Wave checkpoint** ğŸ†• | å„ Guide | 15min | Oracle æ–°å¢ï¼Œç¡®ä¿å¯å›æ»š |

**æ€»è®¡**: ~57 åˆ†é’Ÿ

### P2 - å¯åœ¨æ‰§è¡Œåä¿®å¤

| åºå· | é—®é¢˜ | è¯´æ˜ |
|------|------|------|
| 12 | å ä½ç»„ä»¶è¯´æ˜ | ä¸å½±å“æ‰§è¡Œï¼Œåªæ˜¯å¯è¯»æ€§ |
| 13 | TASKS.md é‡å¤ | Oracle å»ºè®®ï¼šTASKS.md åªåšç´¢å¼•ï¼Œä¸æ”¾ä»£ç  |
| 14 | Git commit æ­¥éª¤ | Oracle å»ºè®®ï¼šç”¨ Wave checkpoint æ›¿ä»£é€ä»»åŠ¡ commit |

---

## ğŸ“ å…·ä½“ä¿®å¤å†…å®¹

### ä¿®å¤ 1: C-003 è¯­æ³•é”™è¯¯

éœ€è¦é‡å†™æ•´ä¸ªæ–‡ä»¶ï¼Œç¡®ä¿:
1. `SSEDeduplicator` ç±»åœ¨æ–‡ä»¶é¡¶å±‚
2. `useStreamingChat` å‡½æ•°åªå®šä¹‰ä¸€æ¬¡
3. `connect` å‡½æ•°å®Œæ•´å®ç°

### ä¿®å¤ 2-4: æ›´æ–°å„ Agent Guide

**GLM-OVERNIGHT-GUIDE.md** Wave 1 ä¿®æ”¹ä¸º:
```markdown
### Wave 1: åŸºç¡€è®¾æ–½ï¼ˆå…ˆåšè¿™äº›ï¼ï¼‰

| é¡ºåº | ä»»åŠ¡ | æ–‡ä»¶ | é¢„è®¡æ—¶é—´ |
|-----|------|------|----------|
| 1 | L-000 | L-000-performance-store.md | 20 min |
| 2 | L-001 | L-001-install-deps.md | 10 min |
| 3 | L-002 | L-002-types-chat.md | 20 min |
| 4 | L-003 | L-003-types-market-panel.md | 20 min |
| 5 | L-004 | L-004-stores.md | 40 min |
```

**CODEX-OVERNIGHT-GUIDE.md** Wave 1 ä¿®æ”¹ä¸º:
```markdown
### Wave 0: Oracle æŠ¤æ ï¼ˆå¿…é¡»é¦–å…ˆæ‰§è¡Œï¼ï¼‰

| é¡ºåº | ä»»åŠ¡ | æ–‡ä»¶ | é¢„è®¡æ—¶é—´ |
|-----|------|------|----------|
| 0a | C-000a | C-000-connection-state-machine.md | 45 min |
| 0b | C-000b | C-000-realtime-debug.md | 20 min |

### Wave 1: å®æ—¶æ•°æ®å±‚

| é¡ºåº | ä»»åŠ¡ | æ–‡ä»¶ | é¢„è®¡æ—¶é—´ |
|-----|------|------|----------|
| 1 | C-001 | C-001-tick-buffer.md | 30 min |
| 2 | C-002 | C-002-market-client.md | 45 min |
```

**DROID-OVERNIGHT-GUIDE.md** ä¿®æ”¹ä¸º:
```markdown
## ğŸ“Š ä»»åŠ¡åˆ—è¡¨

| é¡ºåº | ä»»åŠ¡ | æ–‡ä»¶ | é¢„è®¡æ—¶é—´ |
|-----|------|------|----------|
| 0 | D-000 | D-000-performance-mode-toggle.md | 30 min |
| 1 | D-001 | D-001-responsive-testing.md | 20 min |
| 2 | D-002 | D-002-settings-panel.md | 40 min |
| 3 | D-003 | D-003-style-refinement.md | 30 min |
```

### ä¿®å¤ 5: æ›´æ–° README.md

æ·»åŠ  Wave 0 å’Œæ›´æ–°ç›®å½•ç»“æ„ã€‚

### ä¿®å¤ 6: L-001 æ·»åŠ  lightweight-charts

```bash
pnpm add framer-motion react-resizable-panels cmdk react-markdown remark-gfm lightweight-charts
pnpm add -D @tanstack/react-virtual
```

---

## âœ… å®¡è®¡å®Œæˆåæ£€æŸ¥æ¸…å•

- [ ] C-003 è¯­æ³•é”™è¯¯å·²ä¿®å¤
- [ ] æ‰€æœ‰ Guide å·²æ›´æ–°åŒ…å« -000 ä»»åŠ¡
- [ ] README.md å·²æ›´æ–°
- [ ] L-001 åŒ…å« lightweight-charts
- [ ] L-000 åŒ…å« index.ts æ›´æ–°æ­¥éª¤
- [ ] C-002 è¯´æ˜ä½¿ç”¨ ConnectionStateMachine

---

## ğŸ”® Oracle é¢å¤–é£é™©è­¦å‘Š

Oracle æŒ‡å‡ºä»¥ä¸‹"çœŸå®ä¼šç¿»è½¦"çš„ç‚¹ï¼Œå»ºè®®åœ¨å¯åŠ¨å‰æ·»åŠ æŠ¤æ ï¼š

### A. å¹¶è¡Œ/åˆ†æ”¯åˆå¹¶å†²çª (é«˜é£é™©)

**é—®é¢˜**: 4 agent æ”¹åŒä¸€ä¸ª `client/src/refactor_v2/` æ ‘ï¼Œæœ€å®¹æ˜“çˆ†ç‚¸çš„æ˜¯:
- `types/index.ts`, `stores/index.ts`, `hooks/index.ts` èšåˆå¯¼å‡ºæ–‡ä»¶
- å ä½ç»„ä»¶è¢«åç»­ä»»åŠ¡è¦†ç›–

**æŠ¤æ å»ºè®®**:
```markdown
## ğŸ“ index.ts èšåˆæ–‡ä»¶è´£ä»»å½’å±

| æ–‡ä»¶ | è´Ÿè´£ Agent | å…¶ä»– Agent æƒé™ |
|------|-----------|----------------|
| types/index.ts | GLM (L-002/L-003) | åªè¯» |
| stores/index.ts | GLM (L-004) | Codex å¯è¿½åŠ  |
| hooks/index.ts | GLM (L-007) | Codex å¯è¿½åŠ  |
| components/panels/index.ts | GLM (L-013) | Codex å¯è¿½åŠ  |
| realtime/index.ts | Codex (C-001) | åªè¯» |
```

### B. StrictMode åŒ Effect è§¦å‘ (é«˜é£é™©)

**é—®é¢˜**: React 18 dev ä¸‹ effect æ‰§è¡Œä¸¤æ¬¡ï¼ŒWS/SSE å¦‚æœä¸å¹‚ç­‰ä¼šåŒè¿æ¥

**æŠ¤æ å»ºè®®**: åœ¨ C-000/C-002 ä»»åŠ¡ä¸­æ˜ç¡®:
> âš ï¸ æ‰€æœ‰ `useEffect(() => connect(), [])` å¿…é¡»é€šè¿‡ state machine æˆ– `isConnecting` gate ä¿è¯å¹‚ç­‰

### C. ä»»åŠ¡æ–‡ä»¶ä»£ç å—ä¸å®Œæ•´ (ä¸­é«˜é£é™©)

**é—®é¢˜**: C-003 å·²å‘ç”Ÿ"åŠæˆªç²˜è´´"ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–ä»»åŠ¡å­˜åœ¨ç±»ä¼¼é—®é¢˜

**æŠ¤æ å»ºè®®**: å¯åŠ¨å‰å¿«é€Ÿæ£€æŸ¥:
- æ‰€æœ‰ TypeScript ä»£ç å—åº”æ˜¯"å¯ç‹¬ç«‹ç¼–è¯‘"çš„å®Œæ•´ç‰‡æ®µ
- æˆ–æ˜ç¡®æ ‡æ³¨ `// ... çœç•¥`

### D. API ç«¯ç‚¹ä¸ä¸€è‡´ (ä¸­é£é™©)

**é—®é¢˜**: ä»»åŠ¡é‡Œå†™æ­»äº† `/api/chat/send`ã€SSE endpointï¼Œè‹¥åç«¯ä¸åŒä¼šé›†æˆå¤±è´¥

**æŠ¤æ å»ºè®®**: åˆ›å»ºç«¯ç‚¹å¸¸é‡æ–‡ä»¶:
```typescript
// client/src/refactor_v2/realtime/endpoints.ts
export const ENDPOINTS = {
  WS_MARKET: 'wss://market-api/ws',
  SSE_CHAT: '/api/chat/stream',
  REST_CHAT_SEND: '/api/chat/send',
} as const;
```

---

## ğŸš¦ Oracle æ¨èçš„ Wave Checkpoint æ¨¡æ¿

åœ¨æ¯ä¸ª Agent Guide æœ«å°¾æ·»åŠ :

```markdown
## ğŸš¦ Wave Checkpoint

æ¯å®Œæˆä¸€ä¸ª Wave åæ‰§è¡Œï¼š

\`\`\`bash
# 1. ç±»å‹æ£€æŸ¥
pnpm check

# 2. æ„å»ºéªŒè¯ (Codex è¿˜éœ€è¦ pnpm test)
pnpm build

# 3. æäº¤æ£€æŸ¥ç‚¹
git add client/src/refactor_v2/
git commit -m "checkpoint: [Agent] wave-N complete"
\`\`\`

âš ï¸ å¦‚æœä»»ä½•ä¸€æ­¥å¤±è´¥ï¼Œ**åœæ­¢æ‰§è¡Œ**å¹¶è®°å½•åˆ° ISSUES.md
```

---

## âœ… æœ€ç»ˆä¿®å¤æ£€æŸ¥æ¸…å•

### P0 (å¿…é¡» - å¯åŠ¨å‰)
- [ ] C-003 è¯­æ³•é”™è¯¯å·²ä¿®å¤ï¼ˆSSEDeduplicator ç§»åˆ°é¡¶å±‚ï¼ŒuseStreamingChat åªå®šä¹‰ä¸€æ¬¡ï¼‰
- [ ] GLM Guide å·²æ·»åŠ  L-000
- [ ] Codex Guide å·²æ·»åŠ  C-000a/C-000b
- [ ] Droid Guide å·²æ·»åŠ  D-000

### P1 (å¼ºçƒˆå»ºè®® - å¯åŠ¨å‰)
- [ ] C-000-realtime-debug.md é‡å‘½åä¸º C-009-realtime-debug.md
- [ ] L-001 å·²æ·»åŠ  lightweight-charts
- [ ] L-000 å·²æ·»åŠ  stores/index.ts æ›´æ–°æ­¥éª¤
- [ ] C-002 å·²è¯´æ˜ä½¿ç”¨ ConnectionStateMachine
- [ ] README.md å·²æ›´æ–°
- [ ] å„ Guide å·²æ·»åŠ  index.ts è´£ä»»å½’å±è¡¨
- [ ] å„ Guide å·²æ·»åŠ  Wave Checkpoint æ¨¡æ¿

### P1-å¹¶è¡Œ (å¹¶è¡Œæ‰§è¡ŒæŠ¤æ  - å¿…é¡»)
- [ ] Codex Guide æ·»åŠ  "ç­‰å¾… Gate 1" è¯´æ˜
- [ ] Codex ä»»åŠ¡æ”¹ä¸ºä½¿ç”¨ `hooks/codex.ts` è€Œéä¿®æ”¹ `hooks/index.ts`
- [ ] æ˜ç¡® types/stores/hooks çš„ index.ts ä¸º GLM **åªè¯»**
- [ ] æ·»åŠ  Gate 0 / Gate 1 åˆå¹¶æ£€æŸ¥ç‚¹è¯´æ˜

### P2 (å¯åç»­)
- [ ] L-006 å ä½ç»„ä»¶è¯´æ˜å·²æ·»åŠ 
- [ ] TASKS.md æ”¹ä¸ºåªåšç´¢å¼•

---

## ğŸ“‹ æ‰§è¡Œå‰æœ€ç»ˆç¡®è®¤

### å¹¶è¡Œæ‰§è¡Œè§„åˆ™

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| âŒ å®Œå…¨å¹¶è¡Œ | ä¸å¯è¡Œï¼Œæœ‰ç±»å‹/store ä¾èµ– |
| âœ… åˆ†é˜¶æ®µå¹¶è¡Œ | Wave 0 å¹¶è¡Œ â†’ Gate 1 é¡ºåº â†’ Wave 1+ å¹¶è¡Œ |
| âš ï¸ index.ts | Codex ç¦æ­¢ä¿®æ”¹ï¼Œæ”¹ç”¨ç‹¬ç«‹èšåˆæ–‡ä»¶ |
| âš ï¸ lockfile | åªæœ‰ L-001 å¯ä»¥ä¿®æ”¹ |

### æ‰§è¡Œé¡ºåºç¡®è®¤

```
1. [å¹¶è¡Œ] Wave 0: GLM L-000 + Codex C-000a/C-000b + Droid D-000
   â””â”€â”€ åˆå¹¶ â†’ Gate 0 âœ“

2. [é¡ºåº] Gate 1: GLM L-001 â†’ L-002 â†’ L-003 â†’ L-004
   â””â”€â”€ Codex ç­‰å¾… â†’ Gate 1 âœ“

3. [å¹¶è¡Œ] Wave 1+: GLM L-005~L-016 âˆ¥ Codex C-001~C-008
   â””â”€â”€ åˆå¹¶ â†’ Gate 2 âœ“

4. [é¡ºåº] Wave 4: Droid D-001~D-003 â†’ Amp A-001~A-002
```

---

**å®¡è®¡çŠ¶æ€**: âœ… å®Œæˆ (å« Oracle å¹¶è¡Œå¯è¡Œæ€§ç¡®è®¤)  
**ç»“è®º**: åˆ†é˜¶æ®µå¹¶è¡Œå¯è¡Œï¼Œéœ€æ·»åŠ  Gate æŠ¤æ   
**ä¸‹ä¸€æ­¥**: æŒ‰ä¼˜å…ˆçº§ä¿®å¤ä¸Šè¿°é—®é¢˜  
**é¢„è®¡ä¿®å¤æ—¶é—´**: P0 (~30min) + P1 (~57min) + P1-å¹¶è¡Œ (~30min) = **~2h**
