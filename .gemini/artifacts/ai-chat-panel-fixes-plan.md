# DragonFly ç»¼åˆé—®é¢˜ä¿®å¤è®¡åˆ’

> **åˆ›å»ºæ—¥æœŸ**: 2026-01-26  
> **æ¥æº**: Amp Code Review + ä»Šæ—¥æµ‹è¯•

---

## ğŸ”´ P0 - é˜»å¡ä¸Šçº¿ï¼ˆå¿…é¡»ä¿®å¤ï¼‰

### åç«¯é—®é¢˜

| # | é—®é¢˜ | æ–‡ä»¶ | çŠ¶æ€ | é¢„è®¡å·¥æ—¶ |
|---|------|------|------|---------|
| B1 | æ‰¹é‡ä»»åŠ¡æ— å¹¶å‘é™åˆ¶ | `routers/stocks.ts` | å¾…ä¿®å¤ | 30min |
| B2 | å¤–éƒ¨è¯·æ±‚æ— è¶…æ—¶æ§åˆ¶ | `consensus-analysis.ts` | å¾…ä¿®å¤ | 30min |
| B3 | BaseAgent å¤šè½®çŠ¶æ€ bug | `base-agent.ts` | å¾…ä¿®å¤ | 30min |
| B4 | JSON.parse å¤±è´¥è¢«å½“æˆåŠŸ | `base-agent.ts` | å¾…ä¿®å¤ | 30min |
| B5 | Orchestrator æ¨¡å‹é€‰æ‹©ä¸ç”Ÿæ•ˆ | `orchestrator.ts` | å¾…ä¿®å¤ | 2h |
| B6 | API Key æ³„éœ²é£é™© | `env.ts` | å¾…ä¿®å¤ | 1h |
| B7 | Todo åˆ—è¡¨é‡å¤ (5/9) | `session-store.ts` | âœ… å·²ä¿®å¤ | - |

### å‰ç«¯é—®é¢˜

| # | é—®é¢˜ | æ–‡ä»¶ | çŠ¶æ€ | é¢„è®¡å·¥æ—¶ |
|---|------|------|------|---------|
| F1 | Watchlist N+1 è¯·æ±‚ | `LeftPane.tsx` | å¾…ä¿®å¤ | 2h |
| F2 | AI é¢æ¿ä¸»é¢˜ä¸è·Ÿéš | `theme.store.ts` | âœ… å·²ä¿®å¤ | - |
| F3 | CSS å˜é‡å†²çª | `index.css` | âœ… å·²ä¿®å¤ | - |
| F4 | è¯·æ±‚å¤±è´¥é”™è¯¯å¤„ç† | `AIChatPanel.tsx` | å¾…ä¿®å¤ | 1h |
| F5 | ä»»åŠ¡é¢æ¿çŠ¶æ€ä¸åŒæ­¥ | `TaskExecutionPanel.tsx` | å¾…ä¿®å¤ | 1h |
| F6 | æ‹–åŠ¨æŒ‰é’®ç¼ºå¤± | `LayoutShell.tsx` | å¾…ç¡®è®¤ | ? |

---

## ğŸŸ¡ P1 - å½±å“ç¨³å®šæ€§/æ€§èƒ½

### åç«¯

| # | é—®é¢˜ | æ–‡ä»¶ | é¢„è®¡å·¥æ—¶ |
|---|------|------|---------|
| B8 | getDetail ä¸²è¡Œæ”¹å¹¶è¡Œ | `routers/stocks.ts` | 10min |
| B9 | Agent å†…å­˜æ— é™å¢é•¿ | `base-agent.ts` | 1h |
| B10 | Router åŒæ­¥å†™æ–‡ä»¶é˜»å¡ | `learnable-router.ts` | 1h |
| B11 | é”™è¯¯å‚ä¸å…±è¯†æŠ•ç¥¨ | `consensus-analysis.ts` | 1h |

### å‰ç«¯

| # | é—®é¢˜ | æ–‡ä»¶ | é¢„è®¡å·¥æ—¶ |
|---|------|------|---------|
| F7 | Zustand setTimeout é¡ºåº | `watchlist.store.ts` | 30min |
| F8 | Bundle ä½“ç§¯ 623KB | å¤šå¤„ | 2h |

---

## ä¿®å¤æ‰§è¡Œè®¡åˆ’

### é˜¶æ®µ 1: å¿«é€Ÿä¿®å¤ï¼ˆ30 åˆ†é’Ÿå†…å®Œæˆï¼‰ã€

**åç«¯**:
1. [ ] B2: å¤–éƒ¨è¯·æ±‚åŠ  AbortController + 15s è¶…æ—¶
2. [ ] B3: BaseAgent åŠ  `beginTurn()` é‡ç½®çŠ¶æ€
3. [ ] B4: JSON.parse å¤±è´¥æ—¶ throw Error
4. [ ] B8: getDetail æ”¹ Promise.all å¹¶è¡Œ

**å‰ç«¯**:
1. [ ] F4: ä¼˜åŒ–é”™è¯¯æ¶ˆæ¯å±•ç¤º
2. [ ] F5: ç¡®ä¿ todoRun çŠ¶æ€åŒæ­¥

### é˜¶æ®µ 2: ä¸­ç­‰ä¿®å¤ï¼ˆ1-2 å°æ—¶ï¼‰

1. [ ] B1: åŠ  p-limit å¹¶å‘æ§åˆ¶
2. [ ] B6: env.ts åŠ  server-only æ–­è¨€
3. [ ] F1: åç«¯åŠ æ‰¹é‡è¡Œæƒ…æ¥å£ + å‰ç«¯æ”¹ç”¨ useStockQuotes

### é˜¶æ®µ 3: å¤æ‚ä¿®å¤ï¼ˆ2 å°æ—¶+ï¼‰

1. [ ] B5: Orchestrator æ³¨å…¥æ¨¡å‹é…ç½®åˆ°å­ Agent
2. [ ] B9: Agent å†…å­˜åŠ ä¸Šé™
3. [ ] B10: Router æ”¹ debounce æˆ–ç”¨ DB
4. [ ] B11: å…±è¯†æŠ•ç¥¨è¿‡æ»¤å¤±è´¥ç»“æœ

---

## æ‰§è¡Œå‘½ä»¤

```bash
# å¼€å§‹ä¿®å¤å‰ï¼Œç¡®ä¿æœåŠ¡æ­£å¸¸
pnpm run dev

# ä¿®å¤å®ŒæˆåéªŒè¯
pnpm check
pnpm build
pnpm test
```

---

## å¤‡æ³¨

- ä»Šæ—¥å·²ä¿®å¤: F2, F3, B7
- å¾…ç¡®è®¤: F6 (æ‹–åŠ¨æŒ‰é’®) - éœ€è¦ç”¨æˆ·ç¡®è®¤å…·ä½“åŠŸèƒ½
